<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1320" height="800" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    RAG System Architecture - Docker Compose
  </text>
  
  <!-- Frontend Layer -->
  <rect x="50" y="80" width="300" height="120" fill="#e8f4fd" stroke="#3498db" stroke-width="2" stroke-dasharray="10,5" rx="10"/>
  <text x="200" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#3498db">
    Angular Frontend
  </text>
  <text x="200" y="125" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#7f8c8d">
    rag_frontend
  </text>
  <text x="200" y="145" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    Port: 4300
  </text>
  <text x="200" y="165" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    Volume: ./frontend:/app
  </text>
  
  <!-- Backend Layer -->
  <rect x="450" y="80" width="300" height="120" fill="#e8f5e8" stroke="#27ae60" stroke-width="2" rx="10"/>
  <text x="600" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#27ae60">
    RAG Backend
  </text>
  <text x="600" y="125" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#7f8c8d">
    rag_backend
  </text>
  <text x="600" y="145" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    Port: 8000
  </text>
  <text x="600" y="165" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    Volume: ./backend:/backend
  </text>
  <text x="600" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    Build: ./backend
  </text>
  
<!-- Storage Layer -->
<rect x="20" y="250" width="350" height="160" fill="#fff3cd" stroke="#f39c12" stroke-width="2" rx="10"/>
<text x="195" y="275" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#f39c12">
  Object Storage
</text>

<!-- MinIO -->
<rect x="50" y="290" width="120" height="100" fill="#ffffff" stroke="#e67e22" stroke-width="1" rx="5"/>
<text x="110" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#e67e22">
  MinIO
</text>
<text x="110" y="325" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Ports: 9000, 9001
</text>
<text x="110" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Console: 9001
</text>
<text x="110" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Volume: minio_data
</text>
<text x="110" y="375" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Command: server /data
</text>

<!-- CreateBuckets -->
<rect x="210" y="290" width="120" height="100" fill="#ffffff" stroke="#e67e22" stroke-width="1" rx="5"/>
<text x="270" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#e67e22">
  CreateBuckets
</text>
<text x="270" y="325" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  MinIO MC Client
</text>
<text x="270" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Init Container
</text>
<text x="270" y="355" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Creates buckets
</text>
<text x="270" y="370" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Sets policies
</text>

  
<!-- Prefect Orchestration -->
<rect x="400" y="250" width="900" height="300" fill="#f8e8ff" stroke="#9b59b6" stroke-width="2" rx="10"/>
<text x="850" y="275" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#9b59b6">
  Prefect Orchestration Layer
</text>

<!-- Prefect DB -->
<rect x="430" y="290" width="140" height="120" fill="#ffffff" stroke="#3498db" stroke-width="1" rx="5"/>
<text x="500" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#3498db">
  PostgreSQL
</text>
<text x="500" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
  prefect_db
</text>
<text x="500" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Port: 5432
</text>
<text x="500" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  PostgreSQL 15
</text>
<text x="500" y="370" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Volume:
</text>
<text x="500" y="385" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  prefect_db_data
</text>
<text x="500" y="400" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Metadata Store
</text>

<!-- Prefect Server -->
<rect x="630" y="290" width="140" height="120" fill="#ffffff" stroke="#9b59b6" stroke-width="1" rx="5"/>
<text x="700" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#9b59b6">
  Prefect Server
</text>
<text x="700" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
  prefect
</text>
<text x="700" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Port: 4200
</text>
<text x="700" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  API Server
</text>
<text x="700" y="370" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Web UI
</text>
<text x="700" y="385" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Flow Management
</text>
<text x="700" y="400" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Orchestration
</text>

<!-- Prefect Agent -->
<rect x="830" y="290" width="140" height="120" fill="#ffffff" stroke="#e74c3c" stroke-width="1" rx="5"/>
<text x="900" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#e74c3c">
  Prefect Agent
</text>
<text x="900" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
  agent
</text>
<text x="900" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Queue: default
</text>
<text x="900" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Task Executor
</text>
<text x="900" y="370" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Flow Runner
</text>
<text x="900" y="385" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Dependencies:
</text>
<text x="900" y="400" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  requirements.txt
</text>

<!-- Prefect Init -->
<rect x="1030" y="290" width="160" height="120" fill="#ffffff" stroke="#16a085" stroke-width="1" rx="5"/>
<text x="1110" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#16a085">
  Prefect Init
</text>
<text x="1110" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
  prefect-init
</text>
<text x="1110" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Deployment Setup
</text>
<text x="1110" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
  Flow Registration
</text>
<text x="1110" y="370" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Script:
</text>
<text x="1110" y="385" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  create_deployment.py
</text>
<text x="1110" y="400" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#7f8c8d">
  Init Container
</text>

  
  <!-- Data Flows and Connections -->
  
  <!-- Frontend to Backend (dashed) -->
  <line x1="350" y1="140" x2="450" y2="140" stroke="#3498db" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowblue)"/>
  <text x="400" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#3498db">HTTP</text>
  
  <!-- Backend to MinIO -->
  <line x1="580" y1="200" x2="330" y2="250" stroke="#27ae60" stroke-width="2" marker-end="url(#arrowgreen)"/>
  <text x="440" y="220" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#27ae60">S3 API</text>
  
  <!-- CreateBuckets to MinIO -->
  <line x1="210" y1="340" x2="170" y2="340" stroke="#e67e22" stroke-width="2" marker-end="url(#arroworange)"/>
  
  <!-- Backend to Prefect Server -->
  <line x1="600" y1="200" x2="650" y2="250" stroke="#9b59b6" stroke-width="2" marker-end="url(#arrowpurple)"/>
  <text x="670" y="230" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#9b59b6">Flow API</text>
  
  <!-- Prefect DB to Prefect Server -->
  <line x1="570" y1="350" x2="630" y2="350" stroke="#3498db" stroke-width="2" marker-end="url(#arrowblue)"/>
  
  <!-- Prefect Server to Agent -->
  <line x1="770" y1="350" x2="830" y2="350" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowred)"/>
  
  <!-- Prefect Server to Init (curved path to avoid Prefect Agent) -->
<polyline points="720,410 720,440 1100,440 1100,410" 
          fill="none" stroke="#16a085" stroke-width="2" 
          marker-end="url(#arrowteal)"/>
<text x="850" y="480" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#16a085">
  Flow API
</text>
  
  <!-- Volumes and Persistent Storage -->
  <rect x="50" y="600" width="1100" height="150" fill="#ecf0f1" stroke="#95a5a6" stroke-width="2" rx="10"/>
  <text x="600" y="625" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Persistent Volumes and Configuration
  </text>
  
  <!-- Volume boxes -->
  <rect x="80" y="640" width="180" height="80" fill="#ffffff" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="170" y="660" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    minio_data
  </text>
  <text x="170" y="675" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    MinIO object data
  </text>
  <text x="170" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Files and metadata
  </text>
  <text x="170" y="705" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Bucket storage
  </text>
  
  <rect x="280" y="640" width="180" height="80" fill="#ffffff" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="370" y="660" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    prefect_db_data
  </text>
  <text x="370" y="675" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    PostgreSQL database
  </text>
  <text x="370" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Flow metadata
  </text>
  <text x="370" y="705" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Execution states
  </text>
  
  <rect x="480" y="640" width="180" height="80" fill="#ffffff" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="570" y="660" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    ./backend:/backend
  </text>
  <text x="570" y="675" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Application code
  </text>
  <text x="570" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Hot reload
  </text>
  <text x="570" y="705" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Dev mode
  </text>
  
  <rect x="680" y="640" width="180" height="80" fill="#ffffff" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="770" y="660" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    ./frontend:/app
  </text>
  
  <text x="770" y="675" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Angular code
  </text>
  <text x="770" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    node_modules
  </text>
  
  <rect x="880" y="640" width="180" height="80" fill="#ffffff" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="970" y="660" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    .env
  </text>
  <text x="970" y="675" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Environment variables
  </text>
  <text x="970" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Credentials
  </text>
  <text x="970" y="705" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
    Configuration
  </text>
  
  <!-- Ports Legend -->
  <rect x="850" y="80" width="300" height="120" fill="#f4f4f4" stroke="#7f8c8d" stroke-width="1" rx="10"/>
  <text x="1000" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Exposed Ports
  </text>
  <text x="1000" y="125" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    4300: Angular Frontend
  </text>
  <text x="1000" y="140" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    8000: RAG Backend API
  </text>
  <text x="1000" y="155" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    9000: MinIO API, 9001: MinIO Console
  </text>
  <text x="1000" y="170" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    5432: PostgreSQL
  </text>
  <text x="1000" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">
    4200: Prefect Server UI
  </text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#3498db"/>
    </marker>
    <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#27ae60"/>
    </marker>
    <marker id="arroworange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#e67e22"/>
    </marker>
    <marker id="arrowpurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#9b59b6"/>
    </marker>
    <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#e74c3c"/>
    </marker>
    <marker id="arrowteal" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#16a085"/>
    </marker>
  </defs>
</svg>